---
layout: post
title: "汇编语言"
date: 2021-3-29 17:00:00 +0800
categories: r0code
---

# 32位 
## 基本寄存器
### 8个32位通用寄存器:
#### 4个数据寄存器(EAX、EBX、ECX和EDX)
    eax: 寄存器EAX通常称为累加器(Accumulator)，用累加器进行的操作可能需要更少时间。可用于乘、 除、输入/输出等操作，使用频率很高；也通常用作函数调用返回值。
    ebx: 寄存器EBX称为基地址寄存器(Base Register)。它可作为存储器指针来使用；
    ecx: 寄存器ECX称为计数寄存器(Count Register)。 在循环和字符串操作时，要用它来控制循环次数；在位操作中，当移多位时，要用CL来指明移位的位数；
    edx: 寄存器EDX称为数据寄存器(Data Register)。在进行乘、除运算时，它可作为默认的操作数参与运算，也可用于存放I/O的端口地址。
    
| 32  | 16  | 高8  | 低8  |
|:---:|:---:|:---:|:---:|
| EAX | AX  | AH  | AL  |
| EBX | BX  | BH  | BL  |
| ECX | CX  | CH  | CL  |
| EDX | DX  | DH  | DL  |


#### 2个变址和指针寄存器(ESI和EDI)
    寄存器ESI、EDI、SI和DI称为变址寄存器(Index Register)，它们主要用于存放存储单元在段内的偏移量， 它们可作一般的存储器指针使用。
    
| 32  | 16  |
|:---:|:---:|
| ESI | SI  |
| EDI | DI  |


#### 2个指针寄存器(ESP和EBP)
    它们主要用于访问堆栈内的存储单元，并且规定：
    esp: EBP为基指针(Base Pointer)寄存器，一般作为当前堆栈的最后单元，用它可直接存取堆栈中的数据；
    ebp: 为堆栈指针(Stack Pointer)寄存器，用它只可访问栈顶。
    
    
| 32  | 16  |
|:---:|:---:|
| EBP | BP  |
| ESP | SP  |


### 6个段寄存器(ES、CS、SS、DS、FS和GS)
    es
    cs
    ss
    ds
    fs
    gs
    
### 1个指令指针寄存器(EIP)
    eip ：32位CPU把指令指针扩展到32位，并记作EIP，指令指针EIP、IP(Instruction Pointer)是存放下次将要执行的指令在代码段的偏移量。
    
### 1个标志寄存器(EFlags)
    CF：进位标志
    OF：溢出标志
    SF：符号标志
    ZF：零标志
    AC：辅助进位标志
    PF：奇偶标志




# 指令简表
## 1.数据传送指令
    
| 汇编格式             |  指令的操作                  |
|------------------|--------------------|
| :-:              | :-:                |
| mov dest,source  | 数据传送               |
| CBW              | 字节转换成字             |
| CWD              | 字转换成双字             |
| LAHF             | FLAGS低8位装入AH寄存器    |
| SAHF             | AH寄存器内容送到FLAGS低8位  |
| LDS dest,source  | 设定数据段指针            |
| LES dest,source  | 设定附加段指针            |
| LEA dest,source  | 装入有效地址             |
| PUSH source      | 将一个字压入栈顶           |
| POP dest         | 将一个字从栈顶弹出          |
| PUSHF            | 将标志寄存器FLAGS的内容压入栈顶 |
| POPF             | 将栈顶内容弹出到标志寄存器FLAGS |
| XCHG dest,source | 交换                 |
| XLAT source      | 表转换                |

## 2.算数运算指令

| 汇编格式            | 指令的操作      |
|:---------------:|:----------:|
| AAA             | 加法的ASCII调整 |
| AAD             | 除法的ASCII调整 |
| AAM             | 乘法的ASCII调整 |
| AAS             | 减法的ASCII调整 |
| DAA             | 加法的十进制调整   |
| DAS             | 减法的十进制调整   |
| MUL source      | 无符号乘法      |
| IMUL source     | 整数乘法       |
| DIV source      | 无符号除法      |
| IDIV            | 整数除法         |
| ADD dest,source | 加法         |
| ADC dest,source | 带进位加       |
| SUB dest,source | 减法         |
| SBB dest,source | 带借位减       |
| CMP dest,source | 比较         |
| INC dest        | 加1         |
| DEC dest        | 减1         |
| NEG dest        | 求补         |

## 3.逻辑运算指令

| 汇编格式             | 指令的操作         |
|:----------------:|:-------------:|
| AND dest,source  | 逻辑‘与’         |
| OR dest,source   | 逻辑‘或’         |
| XOR dest,source  | 逻辑‘或非’        |
| NOT dest         | 逻辑‘非’         |
| TEST dest,source | 测试（非破坏性逻辑‘与’） |


## 4.移位指令

| 汇编格式                 | 指令的操作     |
|:--------------------:|:---------:|
| RCL dest,count       | 通过进位循环左移  |
| RCR dest,count       | 通过进位循环右移  |
| ROL dest,count       | 循环左移      |
| ROR dest,count       | 循环右移      |
| SHL / SAL dest,count | 逻辑左移/算数左移 |
| SHR dest,count       | 逻辑右移      |
| SAR dest,count       | 算术右移      |


## 5.串操作指令

| 汇编格式                             | 指令的操作        |
|:--------------------------------:|:------------:|
| MOVS / MOVSB / MOVSW dest,source | 字符串传送        |
| CMPS / CMPSB / CMPSW dest,source | 字符串比较        |
| LODS / LODSB / LODSW source      | 装入字节串或字串到累加器 |
| STOS / STOSB / STOSW dest        | 存储字节串或字串     |
| SCAS / SCASB / SCASW dest        | 字符串扫描        |


## 6.1.程序控制指令

| 汇编格式                         | 指令的操作                |
|:----------------------------:|:--------------------:|
| CALL dest                    | 调用一个过程（子程序）          |
| RET \[ 弹出字节数（必须为偶数）\]        | 从过程（子程序）返回           |
| INT int\_type                | 软件中断                 |
| INTO                         | 溢出中断                 |
| IRET                         | 从中断返回                |
| JMP dest                     | 无条件转移                |
| JG / JNLE short\_label       | 大于或不小于等于转移           |
| JGE / JNL short\_label       | 大于等于或不小于转移           |
| JL / JNGE short\_label       | 小于或不大于等于转移           |
| JLE / JNG short\_label       | 小于等于或不大于转移           |
| JA / JNBE short\_label       | 高于或不低于等于转移           |
| JAE / JNB short\_label       | 高于等于或不低于转移           |
| JB / JNAE short\_label       | 低于或不高于等于转移           |
| JBE / JNA short\_label       | 低于等于或不高于转移           |
| JO short\_label              | 溢出标志为1转移（溢出转移）       |
| JNO short\_label             | 溢出标志为0转移（无溢出转移）      |
| JS short\_label              | 符号标识为1转移（结果为负转移）     |
| JNS short\_label             | 符号标识为1转移（结果为正转移）     |
| JC short\_label              | 进位标志为1转移（有进位转移）      |
| JNC short\_label             | 进位标志为0转移（无进位转移）      |
| JZ / JE short\_label         | 零标志为1转移（等于或为0转移）     |
| JNZ /JNE short\_label        | 零标志为0转移（不等于或不为0转移）   |
| JP /JPE short\_label         | 奇偶标志为1转移（结果中有偶数个1转移） |
| JNP / JPO short\_label       | 奇偶标志为0转移（结果中有奇数个1转移） |
| JCXZ short\_label            | 若CX=0则转移             |
| LOOP short\_label            | CX 不等于0时循环           |
| LOOPE / LOOPZ short\_label   | CX不等于0且ZF=1时循环       |
| LOOPNE / LOOPNZ short\_label | CX不等于0且ZF=0时循环       |
| STC                          | 进位标志置1               |
| CLC                          | 进位标识置0               |
| CMC                          | 进位标志取反               |
| STD                          | 方向标志置1               |
| CLD                          | 方向标志置0               |


## 6.2.程序控制指令

| 汇编格式 | 指令的操作                 |
|:----:|:---------------------:|
| STI  | 中断标志置1（允许可屏蔽中断）       |
| CLI  | 中断标志置0（禁止可屏蔽中断）       |
| ESC  | CPU交权                 |
| HLT  | 停机                    |
| LOCK | 总线封锁                  |
| NOP  | 无操作                   |
| WAIT | 等待至TEST（上边有个横线）信号有效为止 |


## 7.输入/输出指令

| 汇编格式          | 指令的操作       |
|:-------------:|:-----------:|
| IN acc,source | 从外设接口输入字节或字 |
| OUT dest,acc  | 向外设接口输出字节或字 |


## 备注：
    dest 目的操作数、目的串
    source 源操作数、源串
    acc 累加器
    count 计数值
    int_type 中断类型号
    short_label 短距离标号
